# INPUT DATA
hm_articles_input:
  type: pandas.CSVDataSet
  filepath: data/01_raw/hm/articles.csv
  layer: raw
  load_args:
    dtype:
      article_id: str

hm_customers_input:
  type: pandas.CSVDataSet
  filepath: data/01_raw/hm/customers.csv
  layer: raw

hm_transactions_input:
  type: pandas.CSVDataSet
  filepath: data/01_raw/hm/transactions_train.csv
  layer: raw
  load_args:
    dtype:
      article_id: str

# SAMPLE
hm_customers:
  type: pandas.CSVDataSet
  filepath: data/02_intermediate/hm/hm_customers.csv
  layer: intermediate
  save_args:
    index: False

hm_transactions:
  type: pandas.CSVDataSet
  filepath: data/02_intermediate/hm/hm_transactions.csv
  layer: intermediate
  save_args:
    index: False
  load_args:
    dtype:
      article_id: str

hm_articles:
  type: pandas.CSVDataSet
  filepath: data/02_intermediate/hm/hm_articles.csv
  layer: intermediate
  save_args:
    index: False
  load_args:
    dtype:
      article_id: str

# TRAIN VAL SPLIT
hm_transactions_train:
  type: pandas.CSVDataSet
  filepath: data/03_primary/hm/hm_transactions_train.csv
  layer: primary
  save_args:
    index: False
  load_args:
    dtype:
      article_id: str

hm_transactions_val:
  type: pandas.CSVDataSet
  filepath: data/03_primary/hm/hm_transactions_val.csv
  layer: primary
  save_args:
    index: False
  load_args:
    dtype:
      article_id: str

# GRAPH RECOMMENDATION
hm.transactions_graph:
  type: pandas.CSVDataSet
  filepath: data/03_primary/hm/hm_transactions_graph.csv
  layer: primary
  save_args:
    index: False
  load_args:
    dtype:
      item_id: int32
      user_id: int32
    chunksize: 1000000
    low_memory: False

hm_transactions_mapped:
  type: pandas.CSVDataSet
  filepath: data/03_primary/hm/hm_transactions_mapped.csv
  layer: primary
  save_args:
    index: False
  load_args:
    chunksize: 1000000
    low_memory: False

hm_users_mapping:
  type: pickle.PickleDataSet
  filepath: data/03_primary/hm/hm_users_mapping.pickle
  layer: primary
  backend: pickle

hm_items_mapping:
  type: pickle.PickleDataSet
  filepath: data/03_primary/hm/hm_items_mapping.pickle
  layer: primary
  backend: pickle

#DGSR

##train_val_test
hm_dgsr_train_val_test_transactions_graph:
  type: pickle.PickleDataSet
  filepath: data/04_feature/hm/hm_dgsr_train_val_test_transactions_graph.pickle
  layer: feature
  backend: pickle

hm_dgsr_train_val_test_negative_transactions_samples:
  type: pickle.PickleDataSet
  filepath: data/03_primary/hm/hm_dgsr_train_val_test_negative_transactions_samples.pickle
  layer: primary
  load_args:
    chunksize: 1000000
    low_memory: False

hm_dgsr_train_val_test_train_graphs:
  type: recommender_gnn.extras.datasets.graph_dataset.DGSRSubGraphsDataSet
  dir: data/05_model_input/hm/hm_dgsr_train_val_test_train_graphs
  load_args:
    file_extension: bin

hm_dgsr_train_val_test_val_graphs:
  type: recommender_gnn.extras.datasets.graph_dataset.DGSRSubGraphsDataSet
  dir: data/05_model_input/hm/hm_dgsr_train_val_test_val_graphs
  load_args:
    file_extension: bin

hm_dgsr_train_val_test_test_graphs:
  type: recommender_gnn.extras.datasets.graph_dataset.DGSRSubGraphsDataSet
  dir: data/05_model_input/hm/hm_dgsr_train_val_test_test_graphs
  load_args:
    file_extension: bin

##only_train
hm_dgsr_only_train_transactions_graph:
  type: pickle.PickleDataSet
  filepath: data/04_feature/hm/hm_dgsr_only_train_transactions_graph.pickle
  layer: feature
  backend: pickle

hm_dgsr_only_train_negative_transactions_samples:
  type: pickle.PickleDataSet
  filepath: data/03_primary/hm/hm_dgsr_negative_only_train_transactions_samples.pickle
  layer: primary
  load_args:
    chunksize: 1000000
    low_memory: False

hm_dgsr_only_train_train_graphs:
  type: recommender_gnn.extras.datasets.graph_dataset.DGSRSubGraphsDataSet
  dir: data/05_model_input/hm/hm_dgsr_only_train_train_graphs
  load_args:
    file_extension: bin

hm_dgsr_kaggle_gr_model:
  type: kedro_mlflow.io.artifacts.MlflowArtifactDataSet
  layer: model
  data_set:
    type: pickle.PickleDataSet
    filepath: data/06_models/hm/hm_dgsr_kaggle_trained_model.pkl

hm_dgsr_kaggle_gr_predictions:
  type: pandas.CSVDataSet
  filepath: data/07_model_output/hm/hm_dgsr_kaggle_gr_predictions.csv
  layer: model_output
  save_args:
    index: False
  load_args:
    chunksize: 1000000
    low_memory: False

hm_submission:
  type: pandas.CSVDataSet
  filepath: data/07_model_output/hm/hm_submission.csv
  layer: model_output
  save_args:
    index: False
  load_args:
    chunksize: 1000000
    low_memory: False