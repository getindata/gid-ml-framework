import pandas as pd
import pytest


@pytest.fixture
def candidates_dummy_df():
    candidates_dict = {
        "customer_id": {
            0: "caf736a6bd5545a59a3a003ad883eefbeb9653ca1b1b00f766c3f85920635a73",
            1: "633762090ccf0672c702539978d0b8507ef33d538a8393beb54b28a014bfa51c",
            2: "5ac3a43591d11ddcf58d30f2870b26ac3f126d0add6ec815b41a5729e20c2f54",
            3: "932acbb5e5dd33b2d630cebc8f17509321e2a2f8290b82e797a9606f70a5356b",
            4: "0ea10470cc247f589b1ebf41221b6687bdf1da9e4655296f3af789ad9e52961b",
            5: "050edf08cc49397c7d74b99d286ba5842a896ebb15ff1bf72cdf20cdad8fb582",
            6: "3e12fa54db81ddbdc9546974fbbcccb7cafa10b49e48b56bb0f93f6c7fabf222",
            7: "0215d87ba062ce799b1ae7149863bee1a584fdadbc18cdeba0f57d71ed723051",
            8: "97c77e80ca944577a49d6a91c7dd69df7fed135ddfdc04af08cddaf7c05a035f",
            9: "bd2b3948cbe65545f7febda7cb4b8bb7623448c26c98697e8a1f23aa8d1452a6",
            10: "a8cd2c3252c79e6a4339041b9d6cd4eba6e78a37f95743b4564b4f94f1cfe0e5",
            11: "7b297798384e0d52e49d9246821603b0280b2f0d446a75e80b7c4a8a7e77936e",
            12: "5d706ed45b373375d9c421538ab89df78fc99bdd586fcc13f0932563525549ba",
            13: "31302e25c6c663637e26c0f9803fd98a193bc7d4fdf3969870265705a98c292a",
            14: "f3714e6286d025e1280deca7cd0d3ce5db8c3bbb67129a7152a034861cd29f39",
            15: "d464943642575b62001a7d0c55176b98481107f6ec9e02e29eb31092840d83db",
            16: "86e68da86e8411fdcc7dcc9f1ed81d1abdd87d1c387bea926d0d0a0c8f683c04",
            17: "6e9e87c24156e9641b1449e0159abb3b3d06694f331cfb1600be6630245c2280",
            18: "71708841d90876170535a97d647c95d9f766cb5836bc3e7769a8674222136354",
            19: "e70e02a3bb8ca3de47d0deab319dfd3f74d38b7ab1b13b51d0531d3aee330550",
        },
        "article_id": {
            0: "0685814001",
            1: "0761406001",
            2: "0685814001",
            3: "0158340001",
            4: "0896152002",
            5: "0783346011",
            6: "0767423001",
            7: "0855080008",
            8: "0805947001",
            9: "0907527001",
            10: "0863595006",
            11: "0846115002",
            12: "0751471038",
            13: "0706016003",
            14: "0909911001",
            15: "0863595006",
            16: "0874754002",
            17: "0929165002",
            18: "0916468001",
            19: "0730683050",
        },
        "strategy_name": {
            0: "multiple_strategies",
            1: "global_articles",
            2: "multiple_strategies",
            3: "global_articles",
            4: "multiple_strategies",
            5: "previously_bought_prod_name",
            6: "segment_articles",
            7: "previously_bought_prod_name",
            8: "multiple_strategies",
            9: "global_articles",
            10: "multiple_strategies",
            11: "closest_text_embeddings",
            12: "multiple_strategies",
            13: "multiple_strategies",
            14: "global_articles",
            15: "multiple_strategies",
            16: "global_articles",
            17: "multiple_strategies",
            18: "global_articles",
            19: "global_articles",
        },
        "articles_jaccard_similarity": {
            0: 0.13333333333333333,
            1: 0.0,
            2: 0.0,
            3: 0.0,
            4: 0.0,
            5: 0.3825778388278388,
            6: 0.0,
            7: 0.18915750915750915,
            8: 0.06170343137254902,
            9: 0.0,
            10: 0.0,
            11: 0.1810897435897436,
            12: 0.19642857142857142,
            13: 0.0,
            14: 0.0,
            15: 0.13333333333333333,
            16: 0.0,
            17: 0.0,
            18: 0.0,
            19: 0.0,
        },
        "image_cosine_similarity": {
            0: 0.7136101482059594,
            1: 0.0,
            2: 0.0,
            3: 0.0,
            4: 0.0,
            5: 0.9918372479762572,
            6: 0.0,
            7: 0.9985944478140679,
            8: 0.9657978182431505,
            9: 0.0,
            10: 0.0,
            11: 0.9406792837425554,
            12: 0.9791341507364641,
            13: 0.0,
            14: 0.0,
            15: 0.6983822679859496,
            16: 0.0,
            17: 0.0,
            18: 0.0,
            19: 0.0,
        },
        "text_cosine_similarity": {
            0: 0.5321949487533966,
            1: 0.0,
            2: 0.0,
            3: 0.0,
            4: 0.0,
            5: 0.7552847065999805,
            6: 0.0,
            7: 0.37672524858532247,
            8: 0.5617545232785823,
            9: 0.0,
            10: 0.0,
            11: 0.775835782647457,
            12: 0.5246815659250926,
            13: 0.0,
            14: 0.0,
            15: 0.23964840413150404,
            16: 0.0,
            17: 0.0,
            18: 0.0,
            19: 0.0,
        },
    }
    df = pd.DataFrame(candidates_dict)
    return df


@pytest.fixture
def transactions_dummy_df():
    transactions_dict = {
        "t_dat": {
            0: "2020-04-02",
            1: "2020-04-14",
            2: "2020-04-26",
            3: "2020-04-27",
            4: "2020-04-29",
            5: "2020-05-16",
            6: "2020-05-22",
            7: "2020-05-26",
            8: "2020-06-10",
            9: "2020-06-23",
            10: "2020-06-25",
            11: "2020-06-27",
            12: "2020-07-04",
            13: "2020-07-16",
            14: "2020-08-09",
            15: "2020-08-11",
            16: "2020-08-12",
            17: "2020-08-22",
            18: "2020-08-24",
            19: "2020-09-06",
        },
        "customer_id": {
            0: "d6a4823c197897b2c045c5224fe8a1cf89339a636e4980948f0a63cfcd3ac9dd",
            1: "0d1c387ba3ccf49108e891a9ab923f2b933599c1f544037f677b8bb1557e0e0f",
            2: "71708841d90876170535a97d647c95d9f766cb5836bc3e7769a8674222136354",
            3: "1b0d44c80cc7f1ab6b2aeb93389e5c480dce65023460112eb316b3ed7ee0267b",
            4: "46ee80080372849bae7e3e233db952585cbafc128c55b882c993e7780fb959d7",
            5: "cf0f0def412f421e1137400d9dc8a42659665614583932ee503f1653904e1037",
            6: "0ea10470cc247f589b1ebf41221b6687bdf1da9e4655296f3af789ad9e52961b",
            7: "0215d87ba062ce799b1ae7149863bee1a584fdadbc18cdeba0f57d71ed723051",
            8: "6f62df1cb80e0764b04ff81ec7f4810314c05f175e6656d54a7d3d960bd4e10c",
            9: "b64e1c908ace2e4341874c8951d2622f909b2a222efcbcb3b63d3071d2049227",
            10: "e70e02a3bb8ca3de47d0deab319dfd3f74d38b7ab1b13b51d0531d3aee330550",
            11: "3a8795b386ba6e3745a9739a4de066025e6ab54fb12ab5afab8648ee95970d24",
            12: "fd055872f4050c7be48c886d3f8d688e58d9a87d3ba1561eff571c3911a2a5d8",
            13: "932acbb5e5dd33b2d630cebc8f17509321e2a2f8290b82e797a9606f70a5356b",
            14: "1996b3133b3a689fb93fed5b2bbb6dc2aee1c8b1d9d5f07b3cd567a4ebeb78c9",
            15: "7867c2675413742596e6b996883f657380ba9af8f8d65822362ebebb2b0c6f5d",
            16: "bd6816cb23d01058f4ec42813f1f8f5655c4f599ace2965d47a80384fbc37182",
            17: "d464943642575b62001a7d0c55176b98481107f6ec9e02e29eb31092840d83db",
            18: "efcd36e41942092af1231311833cf0773163c5d4ad57c2393973a345488d10f9",
            19: "cf5545e2a292ddce80d7ccdc55079955c2e6f224050e80418ca7163f9054c68b",
        },
        "article_id": {
            0: "0456163064",
            1: "0895506002",
            2: "0811783002",
            3: "0470789001",
            4: "0848256002",
            5: "0729860001",
            6: "0896152002",
            7: "0855080008",
            8: "0721257001",
            9: "0766402030",
            10: "0730683050",
            11: "0880839001",
            12: "0570004010",
            13: "0158340001",
            14: "0885710002",
            15: "0832311002",
            16: "0923361001",
            17: "0599580038",
            18: "0818614007",
            19: "0926166001",
        },
        "price": {
            0: 0.033881355,
            1: 0.02540678,
            2: 0.027101696,
            3: 0.016932203,
            4: 0.014288136,
            5: 0.05083051,
            6: 0.010661017,
            7: 0.013542373,
            8: 0.02201695,
            9: 0.04959322,
            10: 0.008457627,
            11: 0.030491525,
            12: 0.016932203,
            13: 0.022864407,
            14: 0.02201695,
            15: 0.05083051,
            16: 0.013542373,
            17: 0.016932203,
            18: 0.02540678,
            19: 0.04905085,
        },
        "sales_channel_id": {
            0: 2,
            1: 2,
            2: 2,
            3: 2,
            4: 2,
            5: 2,
            6: 1,
            7: 2,
            8: 2,
            9: 2,
            10: 2,
            11: 2,
            12: 1,
            13: 1,
            14: 2,
            15: 1,
            16: 2,
            17: 2,
            18: 1,
            19: 2,
        },
    }
    df = pd.DataFrame(transactions_dict)
    return df


@pytest.fixture
def articles_dummy_df():
    articles_dict = {
        "article_id": {
            0: "0685814001",
            1: "0730683050",
            2: "0623522005",
            3: "0793704001",
            4: "0909911001",
            5: "0783346011",
            6: "0751471038",
            7: "0525500001",
            8: "0598515018",
            9: "0916468001",
        },
        "product_code": {
            0: 892337,
            1: 228257,
            2: 623522,
            3: 793704,
            4: 583425,
            5: 680554,
            6: 556584,
            7: 525500,
            8: 598515,
            9: 693374,
        },
        "prod_name": {
            0: "Clark slim trs tech",
            1: "20 den 2p Tights",
            2: "Nina Strap",
            3: "GREY Scale Tee",
            4: "Robin 3pk Anchor",
            5: "Moccha brazilian",
            6: "Christina patent boot",
            7: "Mike Slim Jogger",
            8: "Fiona Ch Hipster(Poppy)4pk",
            9: "BB SVEN set",
        },
        "product_type_no": {
            0: 272,
            1: 304,
            2: 253,
            3: 255,
            4: 286,
            5: 286,
            6: 87,
            7: 272,
            8: 286,
            9: 270,
        },
        "product_type_name": {
            0: "Trousers",
            1: "Underwear Tights",
            2: "Vest top",
            3: "T-shirt",
            4: "Underwear bottom",
            5: "Underwear bottom",
            6: "Boots",
            7: "Trousers",
            8: "Underwear bottom",
            9: "Garment Set",
        },
        "product_group_name": {
            0: "Garment Lower body",
            1: "Socks & Tights",
            2: "Garment Upper body",
            3: "Garment Upper body",
            4: "Underwear",
            5: "Underwear",
            6: "Shoes",
            7: "Garment Lower body",
            8: "Underwear",
            9: "Garment Full body",
        },
        "graphical_appearance_no": {
            0: 1010016,
            1: 1010016,
            2: 1010010,
            3: 1010016,
            4: 1010001,
            5: 1010016,
            6: 1010016,
            7: 1010016,
            8: 1010016,
            9: 1010016,
        },
        "graphical_appearance_name": {
            0: "Solid",
            1: "Solid",
            2: "Melange",
            3: "Solid",
            4: "All over pattern",
            5: "Solid",
            6: "Solid",
            7: "Solid",
            8: "Solid",
            9: "Solid",
        },
    }
    df = pd.DataFrame(articles_dict)
    return df


@pytest.fixture
def customers_dummy_df():
    customers_dict = {
        "customer_id": {
            0: "0eef970dea82d038c9f0a85a8ac76e001712f138bce479f934e21f9f80f74ead",
            1: "932acbb5e5dd33b2d630cebc8f17509321e2a2f8290b82e797a9606f70a5356b",
            2: "633762090ccf0672c702539978d0b8507ef33d538a8393beb54b28a014bfa51c",
            3: "6d4993166107a18eff7bd82a55c2874270db28f7526e7d2da6a33129c28b5499",
            4: "71708841d90876170535a97d647c95d9f766cb5836bc3e7769a8674222136354",
            5: "caf736a6bd5545a59a3a003ad883eefbeb9653ca1b1b00f766c3f85920635a73",
            6: "f3714e6286d025e1280deca7cd0d3ce5db8c3bbb67129a7152a034861cd29f39",
            7: "50f15803d727117a5db3b4e11f63d254496ff9d2e74e24d7f0e79bd3eaa9fcf2",
            8: "438967b6cf7d8035b2704055ca17fd1a03610bb81e12a11fb43209a706378475",
            9: "86e68da86e8411fdcc7dcc9f1ed81d1abdd87d1c387bea926d0d0a0c8f683c04",
        },
        "FN": {
            0: pd.NA,
            1: pd.NA,
            2: pd.NA,
            3: 1.0,
            4: 1.0,
            5: pd.NA,
            6: pd.NA,
            7: 1.0,
            8: pd.NA,
            9: pd.NA,
        },
        "Active": {
            0: pd.NA,
            1: pd.NA,
            2: pd.NA,
            3: 1.0,
            4: 1.0,
            5: pd.NA,
            6: pd.NA,
            7: 1.0,
            8: pd.NA,
            9: pd.NA,
        },
        "club_member_status": {
            0: "ACTIVE",
            1: "ACTIVE",
            2: "ACTIVE",
            3: "ACTIVE",
            4: "ACTIVE",
            5: "ACTIVE",
            6: "ACTIVE",
            7: "ACTIVE",
            8: "ACTIVE",
            9: "ACTIVE",
        },
        "fashion_news_frequency": {
            0: "NONE",
            1: "NONE",
            2: "NONE",
            3: "Regularly",
            4: "Regularly",
            5: "NONE",
            6: "NONE",
            7: "Regularly",
            8: "NONE",
            9: "NONE",
        },
        "age": {
            0: 34.0,
            1: 57.0,
            2: 53.0,
            3: 34.0,
            4: 41.0,
            5: 22.0,
            6: 28.0,
            7: 26.0,
            8: 35.0,
            9: 74.0,
        },
        "postal_code": {
            0: "b5d203a7c8ec8ed75bf8648239f04ce72260d510ac8f0b4aaa93ae26834f9be0",
            1: "cab69d943b164fe4aa533cc80acd57b4d5987b8df700ab18cf5473b39758e5ea",
            2: "2ec126bd9a1e0cd69f8b3e24ce347152760b195ffbbc65cf144bd0de20611df6",
            3: "2c29ae653a9282cce4151bd87643c907644e09541abc28ae87dea0d1f6603b1c",
            4: "2d558092f25166a37cf12f323157e85102e7d4acb259dc6886e7d135e37371ca",
            5: "ddcc174c8e2d42c0f083aab1792ba880cad8f7514f785356a17166407f898986",
            6: "9dedd0aa9b998c43ea633dd0d0fd960cc81274c73e4e64bd36f08237c8537d25",
            7: "5921d8dad3322e8783fc9ee77c5a065390655d8d1631c9253eeb3947b84e97c8",
            8: "2c29ae653a9282cce4151bd87643c907644e09541abc28ae87dea0d1f6603b1c",
            9: "2c29ae653a9282cce4151bd87643c907644e09541abc28ae87dea0d1f6603b1c",
        },
    }
    df = pd.DataFrame(customers_dict)
    return df
